<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="remiod">
<title>Introduction to remiod • remiod</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to remiod">
<meta property="og:description" content="remiod">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">remiod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title=""><font color="#f64601">1.0.1</font></small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro_remiod.html">Introduction to remiod</a>
	<a class="dropdown-item" href="../articles/theoretic.html">Theoretical Background</a>
	<a class="dropdown-item" href="../articles/example_binary.html">Example: Binary Data Imputation</a>
	<a class="dropdown-item" href="../articles/example_gaussian.html">Example: Continuous Data Imputation Through GLM</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news.html">Change Log</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
  <br>
      <img src="" class="logo" alt=""><h1>Theoretical background</h1>         
    </div>
<p>Tang [2018] proposed a sequential regression approach based on factorization of the joint distribution of longitudinal outcome: <span class="math display">\[\label{eq:factorize}
f(y_{i1},...,y_{iJ}) \quad = \quad \prod_{j=1}^{s_i} f(y_{ij}|\mathbf{z}_{ij},\mathbf{\theta}_j) \prod_{j=s_i+1}^{J} g(y_{ij}|\mathbf{z}_{ij},\mathbf{\theta}_j, \tilde{\mathbf{\theta}}_j),\]</span> where <span class="math inline">\(\mathbf{y}_i = (y_{i1},..., y_{iJ})&#39;\)</span> be the outcomes of participant <span class="math inline">\(i (i=1,...,n)\)</span> having <span class="math inline">\(J\)</span> <span class="math inline">\((j=1,...,J)\)</span> post-baseline visits, and <span class="math inline">\(\mathbf{z}_i = (\mathbf{x}&#39;_i, \mathbf{y}&#39;_{i,j-1} )\)</span>, <span class="math inline">\(\mathbf{z}_{i1} =\mathbf{x}_i = (x_{i1},..., x_{iP})&#39;\)</span> the covariates for participant <span class="math inline">\(i\)</span>. We set <span class="math inline">\(x_{i1}= 1\)</span> for the intercept and <span class="math inline">\(x_{iP} = g_i\)</span> (<span class="math inline">\(g_i=1\)</span> for treated and 0 for control/placebo in a two-arm trial) for the treatment status. In general, <span class="math inline">\(\mathbf{y}_i\)</span> are partially observed. Let <span class="math inline">\(s_i\)</span> be the dropout pattern according to the time of the last observation. We have <span class="math inline">\(s_i = 0\)</span> for participants with no post-baseline assessment, and <span class="math inline">\(s_i = J\)</span> for completers. Thus, <span class="math inline">\(f(y_{ij}|\mathbf{z}_{ij},\theta_j)\)</span> and <span class="math inline">\(g(y_{ij}|\mathbf{z}_{ij},\theta_j, \tilde{\theta}_j)\)</span> are respectively the distribution of the observed and missing outcomes conditioning on the history.</p>
<p>In the sequential regression approach, the proportional odds model is used for ordinal outcomes with <span class="math inline">\(K\)</span> levels <span class="math display">\[\label{eq:clm}
Pr(y_{ij} \leq k|\mathbf{z}_{ij}, \mathbf{\theta}_j) \quad = \quad expit\left(c_{j_k} + \mathbf{\alpha}&#39;_j\mathbf{x}_i + \sum_{t=1}^{j-1}\beta_{jt}y_{it} \right),\]</span> for <span class="math inline">\(k=1,...,K-1\)</span>, where <span class="math inline">\(\mathbf{\alpha}_j = (\alpha_{j1},...,\alpha_{jP})&#39;\)</span>, <span class="math inline">\(c_{j_1} &lt; ... &lt;c_{j_{K-1}}\)</span>, and <span class="math inline">\(expit(\eta) = \exp(\eta)/[1+\exp(\eta)]\)</span>. To ensure <span class="math inline">\(c_{j_k} &gt; c_{j_{k-1}}\)</span>, the reparameterization <span class="math inline">\(d_{j_k} = \log(c_{j_k}-c_{j_{k-1}})\)</span> is applied, and assign normal prior for <span class="math inline">\(d_{j_k}\)</span>: <span class="math display">\[c_{j_1}, d_{j_1}, ...,d_{j_{K-1}} \sim N(\mu_c, \sigma_c^2),\]</span></p>
<p><span class="math display">\[c_{j_k} \sim c_{j_{k-1}} + \exp(d_{j_{k-1}}), k=2,...,K.\]</span></p>
<p>For the binary endpoint, the model reduces to <span class="math display">\[\label{eq:bin}
Pr(y_{ij} = 1|\mathbf{z}_{ij}, \mathbf{\theta}_j) \quad = \quad expit\left(\mathbf{\alpha}&#39;_j\mathbf{x}_i + \sum_{t=1}^{j-1}\beta_{jt}y_{it} \right),\]</span></p>


<h2 id="mi-under-mar-assumption">multiple imputation (MI) under missing-at-random (MAR) assumption</h2>
<p>Imputation with MAR assumption is implemented through two algorithmic backends:</p>
<ul>
<li><p>JAGS: It’s a gibbs sampler under fully Bayesian setting. Under MAR, <span class="math inline">\(g(y_{ij}|\mathbf{z}_{ij},\mathbf{\theta}_j, \tilde{\mathbf{\theta}}_j)\)</span> is identical to <span class="math inline">\(f(y_{ij}|\mathbf{z}_{ij},\mathbf{\theta}_j)\)</span>. Markow chain Monte Carlo (MCMC) with data augmentation (DA) for missing values is realized through <span class="sans-serif">jags</span> <span style="color: 0,0,1"><span class="citation" data-cites="Plummer03jags"></span></span>. Prior distributions have to be specified for all (hyper)parameters. A common prior choice for the regression coefficients is the normal distribution with mean zero and large variance. In <span>remiod</span>, variance parameters are specified as, by default, inverse-gamma distributions.</p></li>
<li><p>Algorithm proposed by Tang[2018]: The algorithm differentiates intermittent missing data and missingness after dropout. Intermittent missing data is imputed first to make missing pattern become monotone. <span style="color: 0,0,1"><span class="citation" data-cites="Tang2018sim"></span></span> proposed a Matroplis-Hasting sampler for the monotone data augmentation (MDA) step. The missing data after dropout can be imputed sequentially given the draw of the model parameters and imputed intermittent missing data after the MDA algorithm converges.</p></li>
</ul>


<h2 id="controlled-mi-under-mnar">Controlled MI under missing-not-at-random (MNAR)</h2>
<h3 id="delta-adjusted-pmm">(1) delta-adjusted pattern mixture model (PMM)</h3>
<p>Let <span class="math inline">\(\delta\)</span> be the sensitivity parameter. Then the adjustment is placed onto the parameter corresponding to treatment variable <span class="math inline">\(g_i\)</span>: <span class="math display">\[\label{eq:clmdelta}
Pr(y_{ij} \leq k|\mathbf{z}_{ij}, \mathbf{\theta}_j) \quad = \quad expit\left[c_{j_k} + \sum_{p=1}^{P-1} \alpha_{jp} x_{ip} + (\alpha_{jP} + \delta) g_i + \sum_{t=1}^{j-1}\beta_{jt}y_{it} \right],\]</span> 
The equation implies MAR in the control group, while the log odds of being in better/worse health status after dropout are reduced compared to those who remain in the trial (<span class="math inline">\(\delta &lt; 0\)</span> if lower scores on <span class="math inline">\(y_{ij}\)</span>’s indicate better health. Otherwise, <span class="math inline">\(\delta &gt; 0\)</span>). In the model, it is impossible to estimate <span class="math inline">\(\delta\)</span> from the observed data. Thus, the method of tipping point analysis is often used, that is, we assume <span class="math inline">\(\delta\)</span> is known and repeat the MI inference at a sequence of increasing <span class="math inline">\(\delta\)</span> values to find the tipping point <span class="math inline">\(\delta\)</span>, at which the treatment effect becomes insignificant. The MAR-based analysis is said to be robust if the tipping point is large and deemed clinically implausible.</p>
<h3 id="copy-reference-pmm">(2) Copy reference PMM</h3>
<p>Copy reference (CR) procedure can be presented as follows: <span class="math display">\[\label{eq:clmcr}
Pr(y_{ij} \leq k|\mathbf{z}_{ij}, \mathbf{\theta}_j) \quad = \quad expit\left[c_{j_k} + \sum_{p=1}^{P-1} \alpha_{jp} x_{ip} + \sum_{t=1}^{j-1}\beta_{jt}y_{it} \right], \forall j &gt; s_i\]</span> Clearly, under CR, treated participants are assumed to gain no benefit even though the treatment was taken, thus having the same mean response profiles as the reference (i.e.control) participants both before and after dropout <span style="color: 0,0,1"><span class="citation" data-cites="pmid24138436"></span></span>.</p>
<h3 id="jump-to-reference-pmm">(3) Jump to reference PMM</h3>
<p>Jump to reference (J2R) assumes that all treatment benefits are gone immediately after participants discontinue the experimental treatment. The unconditional treatment effect at visit <span class="math inline">\(j (j&gt;s_i)\)</span> that is unadjusted for <span class="math inline">\((y_{i1}, … , y_{i,j-1})\)</span> needs to be computed for imputing missing values after dropout [Tang 2018].</p>    


<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-tang2017" class="csl-entry">
Tang, Y. (2018). <span>“Controlled Pattern Imputation for Sensitivity Analysis of Longitudinal Binary and Ordinal Outcomes with Nonignorable Dropout.”</span> <em>Statistics in Medicine</em> 37 (9): 1467–81. 
<a href="https://doi.org/10.1002/sim.7583"> DOI: 10.1002/sim.7583 </a>
</div>
<div id="ref-wang2022" class="csl-entry">
Wang, T. and Liu, Y. (2022). <span>“Remiod: Reference-Based Controlled Multiple Imputation of Longitudinal Binary and Ordinal Outcomes with Non-Ignorable Missingness.”</span> 
<a href="https://arxiv.org/pdf/2203.02771"><em>arXiv: 2203.02771</em></a>.
</div>
</div>
</div>
 
  </main>

<aside style="float:right" class="col-md-3">
<div class="vignette">
<br>
<h2 data-toc-skip>Vignettes</h2>
<ul class="list-unstyled">
<li> <a href="../articles/intro_remiod.html">Introduction to remiod</a> </li>
<li> <a href="../articles/theoretic.html">Theoretical Background</a> </li>
<li> <a href="../articles/example_binary.html">Example: Binary Data Imputation</a> </li>
<li> <a href="../articles/example_gaussian.html">Example: Continuous Data Imputation Through GLM</a> </li> 
</ul>
</div>
</aside>	
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ying Liu, Tony Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
